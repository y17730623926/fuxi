<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <style>
        * {
            padding: 0;
            margin: 0;
        }
        th,td{
            width: 20%;
            text-align: center;
            font-size: 18px;
        }
        .create {
            display: none;
        }
    </style>
</head>
<body>
    <table class="table table-hover">
        <thead>
            <tr>
                <th>车辆</th>
                <th>起始地</th>
                <th>目的地</th>
                <th>时间</th>
                <th>操作</th>
            </tr>
            <tr class="create">
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
            <tr>
                <td>子弹头</td>
                <td>地球</td>
                <td>月球</td>
                <td>2000.12.15</td>
                <td>
                    <button class="btn btn-success">添加</button>
                    <button class="btn btn-warning">删除</button>
                </td>
            </tr>
        </tbody>
    </table>
    <script>
        /*
            事件委托： 将子集的事件委托给父级元素(能包括完所有有委托的子级)
                缺点：this 改变    可以使用事件对象下的 event.target 替换 this
                优点：1.解决新添加的元素无法绑定事件
                    2.性能更好
        */
        (function () {
            //获取所有的td
            var td = document.querySelectorAll("td");
            //获取所有的删除
            var del_btn = document.querySelectorAll(".btn-warning");
            //获取所有的添加
            var create_btn = document.querySelectorAll(".btn-success");
            //获取tbody
            var tbody = document.querySelector("tbody");
            //获取添加模板
            var mb_tr = document.querySelector(".create");
            for (var i = 0; i < del_btn.length; i++) {
                del_btn[i].onclick = function () {
                    //用tbody调用删除tr
                    tbody.removeChild(this.parentNode.parentNode);
                }
            }
            for (var s = 0; s < create_btn.length; s++) {
                create_btn[s].onclick = function () {
                    var mb_tr_cope = mb_tr.cloneNode(true);
                    mb_tr_cope.className = "";
                    this.parentNode.parentNode.parentNode.insertBefore(mb_tr_cope,this.parentNode.parentNode.nextElementSibling)
                }
            }
            for (var j = 0; j < td.length; j++) {
                td[j].onclick = function () {
                    if (this.children.length === 0) {
                        //创建一个input
                        var input = document.createElement("input");
                        input.type = "text";
                        //获取清除之前的txt文本
                        var txt = this.innerText;
                        //清除添加之前的txt文本
                        this.innerText = "";
                        //添加清除之前的文本到input里面
                        input.value = txt;
                        //增加input进去td里面
                        this.appendChild(input);
                        //添加进去之后直接获取焦点，debug
                        input.focus();
                        //存储点击的 td 的 this , 失去焦点时要用
                        var _this = this;
                        //添加失去焦点要进行的代码
                        input.onblur = function () {
                            //存储失去焦点时input的value
                            var td_txt = input.value;
                            //修改td的内容
                            _this.innerText = td_txt;
                        }
                    }
                }
            }
        })();
    </script>
</body>
</html>